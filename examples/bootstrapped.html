<html>
<head>
	<meta charset="utf-8"/>
	<title>Potree Viewer</title>
	<!--<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">-->
	<link rel="stylesheet" type="text/css" href="css/potree.css">
	
	<link href="../libs/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
	
	<style>
	.navbar-primary .navbar .nav > li > a:hover {background-color: #000000;}
	.navbar-primary .navbar .nav.pull-right {margin-left: 10px; margin-right: 0;}
	.navbar-xs .navbar-primary .navbar { position: relative; margin: 0px; min-height:34px; height: 34px; }
	.navbar-xs .navbar-primary .navbar .navbar-brand{ padding: 3px 12px;font-size: 16px;line-height: 28px; }
	.navbar-xs .navbar-primary .navbar .navbar-nav > li > a {  padding: 2 5; line-height: 34px; height: 34px;}
	.navbar-xs .navbar-primary .navbar .navbar-nav > li > a > img {  width: 50px; height: 50px; padding: 0; position: relative; z-index: 100}
	.navbar-xs .navbar-primary .navbar .navbar-nav > li > img {  width: 32px; height: 32px; padding: 0; position: relative; z-index: 100}
	li.dropdown.open > ul {  z-index: 1; padding-top: 15px;}
	.nav > li > a{ padding: 10px 6px; }
	
	.navbar{
		border-radius: 0px;
		margin: 0;
	}
	
	.navbar-xs .navbar-primary .navbar .navbar-nav > li > div {  padding-top: 0px; padding-bottom: 0px; line-height: 34px; height: 34px;}
	.nav > li > div{ margin: 10px; padding: 10px 6px; }
	.dropdown-menu > li > div{ padding: 3px 20px }
	
	.radio label{
		width: 100%;
	}
	
	li.dropdown.open > ul{
		-webkit-touch-callout: none;
		-webkit-user-select: none;
		-khtml-user-select: none;
		-moz-user-select: none;
		-ms-user-select: none;
		user-select: none;
		min-width: 200px;
	}
	
	li.dropdown.open > ul > li > label {
		width: 100%;
		padding: 3px 20px;
		font-weight: 100;
	}
	
	li.dropdown.open > ul > li > label:hover{
		background-color: #f5f5f5;
	}
	
	.horizontal-separator{
		position:	absolute !important;
		top: 4px;
		bottom: 4px;
		border: 1px solid gray;
	}	

	</style>
	
	
</head>
<body>

	<script src="../libs/three.js/build/three.js"></script>
	<script src="../libs/other/stats.min.js"></script>
	<script src="../libs/other/dat.gui.min.js"></script>
	<script src="../libs/other/BinaryHeap.js"></script>
	<script src="../libs/tween/tween.min.js"></script>
	<script src="../libs/d3/d3.js"></script>
	
	<script src="../build/js/potree.js"></script>
	<script src="./js/viewer.js"></script>
	<script src="./js/ProgressBar.js"></script>
	
	<!-- uncomment this to debug changes to the individual js files -->
	
	<script src="../src/PointCloudOctree.js"></script>
	<script src="../src/PointCloudOctreeGeometry.js"></script>
	<script src="../src/loader/POCLoader.js"></script>
	<script src="../src/loader/BinaryLoader.js"></script>
	<script src="../src/loader/LasLazLoader.js"></script>
	<script src="../src/materials/PointCloudMaterial.js"></script>
	<script src="../src/materials/EyeDomeLightingMaterial.js"></script>
	<script src="../src/EarthControls.js"></script>
	<script src="../src/OrbitControls.js"></script>
	<script src="../src/FirstPersonControls.js"></script>
	<script src="../src/GeoControls.js"></script>
	<script src="../src/utils/ProfileTool.js"></script>
	<script src="../src/utils/MeasuringTool.js"></script>
	<script src="../src/utils/TransformationTool.js"></script>
	<script src="../src/utils/VolumeTool.js"></script>
	<script src="../src/utils.js"></script>
	<script src="../src/LRU.js"></script>
	<script src="../src/Annotation.js"></script>
	<script src="../src/TextSprite.js"></script>
	<script src="../src/Features.js"></script>
	<script src="../src/extensions/PerspectiveCamera.js"></script>
	<script src="../src/arena4d/PointCloudArena4D.js"></script>
	<script src="../src/arena4d/PointCloudArena4DGeometry.js"></script>
	
	
	<!-- INCLUDE ADDITIONAL DEPENDENCIES HERE -->
	<!-- INCLUDE SETTINGS HERE -->
	<script src="../libs/plasio/js/laslaz.js"></script>
	<script src="../libs/plasio/vendor/bluebird.js"></script>
	<script src="../build/js/laslaz.js"></script>
	
	
	
	
	
	
	
	
	<div style="height: 100%;">
	<div class="navbar-xs" id="navbar" style="z-index: 10000">
	<div class="navbar-primary">
	<nav class="navbar navbar-primary navbar-inverse">
		<div class="navbar-collapse collapse">
		  <!--
		  <a class="navbar-brand" href="http://potree.org" target="_blank" title="Potree">
			  Potree.org
		  </a>
		  -->
		 
		  
		  
		   <ul class="nav navbar-nav navbar-left">
			<li></li>  
		   
			<li class="dropdown">
              <a href="#" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false">
				<!--Appearance-->
				<img src="../resources/icons/round_dropdown.png" width="40" />
			  </a>
              <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dLabel" style="width: 250px"> 
				<li data-toggle="tooltip" data-placement="right" title="Maximum number of points that will be rendered."><a href="#" class="small" data-value="option3" tabIndex="-1">
					Point Budget: <span id="lblPointBudget"></span> 
					<div id="sldPointBudget"></div>
				</a></li>
				
				<li tabIndex="-1"><a href="#" class="small" data-value="option3" tabIndex="-1">
					Point Size: <span id="lblPointSize"></span> 
					<div id="sldPointSize"></div>
				</a></li>
				
				<li><a href="#" class="small" data-value="option3" tabIndex="-1">
					Field of View: <span id="lblFOV"></span>
					<div id="sldFOV"></div>
				</a></li>
				
				<li><a href="#" class="small" data-value="option3" tabIndex="-1">
					Opacity: <span id="lblOpacity"></span>
					<div id="sldOpacity"></div>
				</a></li>
				
				<li><label class="menu-item"><input type="checkbox" onClick="toggleSkybox(this)"/>&nbsp;Skybox</label></li>
				
				
				
				<li role="separator" class="divider"></li>
                <li class="dropdown-header">Point Sizing</li>
				
				<li data-toggle="tooltip" data-placement="right" title="Point Size = pixel size. Same pixel size for all points"><label><input type="radio" id="optPointSizing_Fixed" name="optPointSizing" onClick="viewer.setPointSizing(this.value);" value="Fixed" /> Fixed</label></li>
				<li data-toggle="tooltip" data-placement="right" title="Point Size = scene units, e.g. meters. Distant points become smaller."><label><input type="radio" id="optPointSizing_Attenuated" name="optPointSizing" onClick="viewer.setPointSizing(this.value);" value="Attenuated" /> Attenuated</label></li>
				<li data-toggle="tooltip" data-placement="right" title="Point Size = factor. Points are automatically resized according to level of detail. Works best with a point size of 1 or smaller."><label><input type="radio" id="optPointSizing_Adaptive" name="optPointSizing" onClick="viewer.setPointSizing(this.value);" value="Adaptive" /> Adaptive</label></li>
				
				
				
				<li role="separator" class="divider"></li>
                <li class="dropdown-header">Quality</li>
				
				<li data-toggle="tooltip" data-placement="right" title="Render each point as a square. Very fast."><label><input type="radio" id="optQuality_Squares" name="optQuality" onClick="viewer.setQuality(this.value);" value="Squares" /> Squares</label></li>
				<li data-toggle="tooltip" data-placement="right" title="Render each point as a circle. Very fast."><label><input type="radio" id="optQuality_Circles" name="optQuality" onClick="viewer.setQuality(this.value);" value="Circles" /> Circles</label></li>
				<li data-toggle="tooltip" data-placement="right" title="Nearest-neighbour-like interpolation between overlapping points. Better quality but slower. Only works if EDL is disabled, at the moment."><label><input type="radio" id="optQuality_Interpolation" name="optQuality" onClick="viewer.setQuality(this.value);" value="Interpolation" /> Interpolation</label></li>
				<li data-toggle="tooltip" data-placement="right" title="Highest Quality but slowest. Only works if EDL is disabled, at the moment."><label><input type="radio" id="optQuality_Splats" name="optQuality" onClick="viewer.setQuality(this.value);" value="Splats" /> HQ-Splats</label></li>
				
				
				
				<li role="separator" class="divider"></li>
                <li class="dropdown-header">Eye-Dome-Lighting</li>
				
				<li data-toggle="tooltip" data-placement="right" title="Illumination for point clouds without normals. Must be disabled if you want to use interpolation or HQ-Splat modes."><label><input type="checkbox" id="chkEDLEnabled" onClick="viewer.setEDLEnabled(this.checked)"/>&nbsp;enable</label></li>
				<li><a href="#" class="small" data-value="option3" tabIndex="-1">
					radius <span id="lblEDLRadius"></span>
					<div id="sldEDLRadius"></div>
				</a></li>	
				
				<li><a href="#" class="small" data-value="option3" tabIndex="-1">
					strength <span id="lblEDLStrength"></span>
					<div id="sldEDLStrength"></div>
				</a></li>
				
              </ul>
            </li>
			
			
			
			<li class="dropdown">
              <a href="#" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false">
				<!--Materials -->
				<img src="../resources/icons/round_dropdown.png" width="40" />
			  </a>
              <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dLabel"> 
				<li id="materialList">
					<!-- filled on load -->
				</li>
              </ul>
            </li>
			
			<li class="dropdown">
              <a href="#" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false">
				<!--Classifications -->
				<img src="../resources/icons/round_dropdown.png" width="40" />
			  </a>
              <ul  id="classificationList" class="dropdown-menu" role="menu" aria-labelledby="dLabel"> 
				<li id="classificationList">
					<!-- filled on load -->
				</li>
              </ul>
            </li>
			
			
			
			
			<li class="dropdown">
              <a href="#" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false">
				<!--Navigation -->
				<img src="../resources/icons/round_dropdown.png" width="40" />
			  </a>
              <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dLabel"> 
				
                <li class="dropdown-header">Navigation Mode</li>
				
				<li data-toggle="tooltip" data-placement="right" title="Rotate around pivot point. Double click to set new pivot and zoom towards it."><label><input type="radio" id="optNavigation_Orbit" name="optNavigation" onClick="viewer.setNavigationMode(this.value);" value="Orbit" /> Orbit</label></li>
				<li data-toggle="tooltip" data-placement="right" title="Fly through scene using W,A,S,D and left mouse button"><label><input type="radio" id="optNavigation_Flight" name="optNavigation" onClick="viewer.setNavigationMode(this.value);" value="Flight" /> Free-Flight</label></li>
				<li data-toggle="tooltip" data-placement="right" title="Drag through scene with left button and rotate with right button."><label><input type="radio" id="optNavigation_Earth" name="optNavigation" onClick="viewer.setNavigationMode(this.value);" value="Earth" /> Earth</label></li>
				
				<li role="separator" class="divider"></li>
                <li class="dropdown-header">Views</li>
				
				<li><a href="#" onclick="viewer.fitToScreen()">Fit-To-Screen</a></li>
				<li><a href="#" onclick="viewer.setFrontView()" >Front</a></li>
				<li><a href="#" onclick="viewer.setTopView()" >Top</a></li>
				<li><a href="#" onclick="viewer.setRightView()" >Right</a></li>
				<li><a href="#" onclick="viewer.setLeftView()" >Left</a></li>
				
				<li role="separator" class="divider"></li>
				<li><a href="#" onclick="viewer.flipYZ();">Swap YZ coordinates</a></li>
				
              </ul>
            </li>
			
			
		   
			<li class="dropdown">
              <a href="#" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false">
				<!--Settings -->
				<img src="../resources/icons/round_dropdown.png" width="40" />
			  </a>
              <ul class="dropdown-menu" >
				<li data-toggle="tooltip" data-placement="right" title="Nodes with smaller size on screen will not be rendered. Increase to improve performance."> <a href="#" class="small" data-value="option3" tabIndex="-1">
					Min Node Size<div id="minNodeSize"></div>
				</a></li>
				
				<li role="separator" class="divider"></li>
				<li class="dropdown-header">Clip Mode</li>
				
				<li data-toggle="tooltip" data-placement="right" title="No clipping of points outside height profile or clip volumes."><label><input type="radio" id="optClipMode_NoClipping" 		name="optClipMode" onClick="viewer.setClipMode(Potree.ClipMode.DISABLED);"  /> No Clipping</label></li>
				<li data-toggle="tooltip" data-placement="right" title="Only render points inside height profile or clip volume."><label><input type="radio" id="optClipMode_ClipOutside" 	name="optClipMode" onClick="viewer.setClipMode(Potree.ClipMode.CLIP_OUTSIDE);"  /> Clip Outside</label></li>
				<li data-toggle="tooltip" data-placement="right" title="Highlight points inside height profile or clip volume and render remaining points normally."><label><input type="radio" id="optClipMode_HighlightInside" name="optClipMode" onClick="viewer.setClipMode(Potree.ClipMode.HIGHLIGHT_INSIDE);"  /> Highlight Inside</label></li>
				
				<li role="separator" class="divider"></li>
                <li class="dropdown-header">Debug</li>
				<li><label><input type="checkbox" id="chkShowStats" onClick="viewer.setShowStats(this.checked)"/>&nbsp;Stats</label></li>
				<li><label><input type="checkbox" id="chkShowDebugInfos" onClick="viewer.setShowDebugInfos(this.checked)"/>&nbsp;Debug Infos</label></li>
				<li><label><input type="checkbox" id="chkShowBoundingBox" onClick="viewer.setShowBoundingBox(this.checked)"/>&nbsp;Bounding Box</label></li>
				<li><label><input type="checkbox" id="chkFreeze" onClick="viewer.setFreeze(this.checked)"/>&nbsp;Freeze</label></li>
              </ul>
            </li>
			
			<li class="dropdown">
              <a href="#" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false">
				<!--Help -->
				<img src="../resources/icons/round_dropdown.png" width="40" />
			  </a>
              <ul class="dropdown-menu">
				<li><a href="https://github.com/potree/potree/blob/master/docs/documentation.md" target="_blank" class="small" data-value="option3" tabIndex="-1">Documentation</a></li>
				<li><a href="#" class="small" data-toggle="modal" data-target="#myModal">About</a></li>
              </ul>
            </li>
			
			<li class="dropdown">
              <a href="#" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false" onclick="toggleProfileWindow();">
				<!--Height Profile Window -->
				<img src="../resources/icons/round_popup.png" width="40" />
			  </a>
            </li>
			
          </ul>
		  
			<ul class="nav navbar-nav navbar-right" ><li></li></ul>
			<ul class="nav navbar-nav navbar-right" id="toolbar"></ul>
			<ul class="nav navbar-nav navbar-right" id="navigationbar"></ul>
		</div>
    </nav>
	</div>
	</div>
	
	<div id="renderArea" style="position: absolute; top: 34px; right: 0; left: 0; bottom: 0; overflow: hidden;">

		<div id="overlays" style="position: absolute; left: 10px; top: 45px;">
		</div>
	
		<!-- HEADING -->
		<div id="description" class="info" style="position: absolute; top: 10px; left: 50%; transform: translateX(-50%); text-align: center"></div>
	</div>
	
	</div>

	

	<!-- About Dialog -->
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
			<h4 class="modal-title" id="myModalLabel">About Potree</h4>
		  </div>
		  <div class="modal-body">
			Version: 1.3<br>
			<br>
			Author: Markus Sch&uuml;tz<br>
			mschuetz@potree.org<br>
			<br>
			Developed at the <a href="https://www.cg.tuwien.ac.at/" target="_blank">Vienna University of Technology, 
			Institute of Computer Graphics and Algorithms</a>
			<br>
			<br>
			Homepage: <a href="http://potree.org" target="_blank">http://potree.org</a><br>
			Github: <a href="https://github.com/potree/potree" target="_blank">https://github.com/potree/potree</a><br>
			
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		  </div>
		</div>
	  </div>
	</div>
	
	
	
	
	
	
	<!--
	<style>
	
	.pw_root{
		width: 400px;
		height: 200px;
		border:	2px solid black;
	}
	
	.pw_titlebar{
		position: absolute;
		height: 30px;
		background-color: blue;
		left: 0px;
		right: 0px;
	}
	
	.pw_content{
		position: absolute;
		top: 30px;
		left: 0px;
		right: 0px;
		bottom: 0px;
	}
	
	</style>
	
	<div id="profile_panel" class="pw_root" style="position: absolute; width: 400px">
		<div id="profile_panel_titlebar" class="pw_titlebar">
            <div id="profile_panel_minimizeButton" class="ui-icon ui-icon-circle-minus"></div>
            <div id="profile_panel_info"></div>
        </div>
		<div style="display: flex; flex-direction: row" class="pw_content">
			<span style="width: 200px; height: 100%; background-color: red">
			asd
			</span>
			
			<span style="height: 100%; background-color: green; flex-grow: 1">
			asd
			</span>
		</div>
	</div>
	
	-->
	
	
	<div id="profile" style="display: none; position: absolute; top: 100; left: 10; width: 600px; height: 300px; background-color: #222; border: 1px solid black">
		
		<div id="profile_titlebar" style="display: flex; background-color: #111; color: #9d9d9d; position: absolute; height: 30px; width: 100%;">
		<span style="flex-grow: 1; flex-direction: row">Height Profiles</span>
		<span>close</span>
		</div>
		
		<div style="position: absolute; top: 30px; width: 100%; height: calc(100% - 30px);" class="pw_content">
			
			<span style="height: 100%; width: 100%; background-color: #222; padding: 5px; display:flex; flex-direction: column">
				<div style=" width: 100%; background-color: #222; color: #9d9d9d">
				

				

				<table style="color: #9d9d9d">
					<tr>
						<td style="padding: 1 5; white-space: nowrap">Select Profile</td>
						<td style="width: 100%">
							<!--<span id="profile_button_container" style="whitespace: nowrap"></span>-->
							<div id="profile_button_container" class="btn-group btn-group-xs" role="group" aria-label="...">
							</div>
							</td>
					</tr>
					<tr>
						<td style="padding: 1 5; white-space: nowrap">Points in profile</td>
						<td><span id="profile_num_points">-</span></td>
					</tr>
					<tr>
						<td style="vertical-align: top; padding: 1 5; white-space: nowrap">Markers</td>
						<td><span id="profile_markers">-</span></td>
					</tr>
				</table>
				<br>
				</div>
				
				<div id="profile_draw_container" style="
					width: 100%; 
					background-color: #222; 
					flex-grow: 1; 
					position: relative; height: 100%">
					<div style="
						position: absolute; 
						left: 41; 
						top: 0; 
						bottom: 20; 
						width: calc(100% - 41px); 
						height: calc(100% - 20px); 
						background-color: #000000;
						"></div>
					<svg id="profileSVG" style="
						fill: #9d9d9d;
						position: absolute; 
						left: 0; right: 0; 
						top: 0; bottom: 0; 
						width: 100%; 
						height: 100%;
						/*background-color: #222;*/
						"></svg>
					<canvas id="profileCanvas" style="
						position: absolute; 
						left: 41; 
						top: 0; 
						bottom: 20; 
						width: calc(100% - 41px); 
						height: calc(100% - 20px); 
						/*background-color: #000000;*/
						"></canvas>
					
				</div>
			</span>
		</div>
	
	</div>
	
	
	
	
	<!-- Bootstrap core JavaScript-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <script src="../libs/bootstrap/js/bootstrap.min.js"></script>
		
	<script>
	
		var onPointCloudLoaded = function(event){
			// do stuff here that should be executed once a point cloud has been loaded.
			// event.pointcloud returns the point cloud object
			console.log("a point cloud has been loaded");
			
			// set up things when the first point cloud has been loaded
			if(viewer.pointclouds.length === 1){
				//viewer.flipYZ();
				viewer.setNavigationMode("Orbit");
				//viewer.useEarthControls();
				viewer.zoomTo(event.pointcloud, 1);
			
				//viewer.camera.position.set(814, 100, 155);
				//viewer.camera.lookAt(new THREE.Vector3(768, 59, 110))
				//viewer.orbitControls.target = new THREE.Vector3(768, 59, 110);
			}
		};
	
		viewer = new Potree.Viewer(document.getElementById("renderArea"), {
			"onPointCloudLoaded": onPointCloudLoaded
		});
		
		viewer.setEDLEnabled(false);
		viewer.setPointSize(3);
		viewer.setMaterial("RGB");
		viewer.setFOV(60);
		viewer.setPointSizing("Fixed");
		viewer.setQuality("Squares");
		viewer.setPointBudget(1*1000*1000);
		viewer.setShowNavbar(true);
		viewer.setShowToolbar(true);
		viewer.setDescription("New User Interface Prototype<br>Feedback to mschuetz@potree.org");
		
		//viewer.addPointCloud("http://localhost/temp/layers/1/cloud.js", function(pointcloud){
		//	console.log("point cloud 1 loaded");
		//});
		//viewer.addPointCloud("http://localhost/temp/layers/2/cloud.js", function(pointcloud){
		//	console.log("point cloud 2 loaded");
		//});
		
		//viewer.addPointCloud("http://5.9.65.151/mschuetz/potree/resources/pointclouds/archpro/heidentor/cloud.js");
		viewer.addPointCloud("http://5.9.65.151/mschuetz/potree/resources/pointclouds/opentopography/CA13/cloud.js");
		
		
	</script>


	<script>
	
	function toggleProfileWindow(){
		$("#profile").fadeToggle(300);
	}
	
	{
		// http://stackoverflow.com/questions/25089297/twitter-bootstrap-avoid-dropdown-menu-close-on-click-inside/25196101#25196101
		// manually define dropdown behaviour
		// this does not close dropdown menus through clicks on a menu item
		$('li.dropdown a').on('click', function (event) {
			$(this).parent().toggleClass('open');
		});

		$('body').on('mousedown', function (e) {
			if (!$('li.dropdown').is(e.target) 
				&& $('li.dropdown').has(e.target).length === 0 
				&& $('.open').has(e.target).length === 0
			) {
				$('li.dropdown').removeClass('open');
			}
		});
		
		$('li.dropdown > a').on('mouseover', function (event) {
			$('.open').removeClass("open");
			$(this).parent().addClass('open');
		});
		
		
		
		//$('li.dropdown > ul').on('mouseleave', function (event) {
		//	$(this).parent().removeClass('open');
		//});
		
//		#navbar > div > nav > div > ul.nav.navbar-nav.navbar-left > li:nth-child(5)
	}
	
	$(document).ready(function(){
		$('[data-toggle="tooltip"]').tooltip({
			viewport: {selector: 'body', padding: 2},
			container: 'body'
		}); 
	});
	
	$("#profile").draggable({
        handle: "#profile_titlebar",
        containment: 'window',
        scroll: false
    }).draggable({ scroll: false });  
	
	$("#profile").resizable({
        minHeight: 15,
        stop: function(event, ui) {
            
        }
    })
	
	</script>
	
</body>
</html>













